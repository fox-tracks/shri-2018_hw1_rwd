"use strict";!function(){const e=["sosed","cat","dog","hall"];function t(e,t){if(Hls.isSupported()){const o=new Hls;o.loadSource(t),o.attachMedia(e),o.on(Hls.Events.MANIFEST_PARSED,function(){e.play()})}else e.canPlayType("application/vnd.apple.mpegurl")&&(e.src=t,e.addEventListener("loadedmetadata",function(){e.play()}))}function o(t){const o=t.dataset.key;return e[o-1]}const n=Array.from(document.querySelectorAll("main .card__video"));let a,c;n.forEach(e=>{t(e,`http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2F${o(e)}%2Fmaster.m3u8`)});const r=document.querySelector(".page__popup"),s=document.querySelector(".page"),l=document.querySelector(".popup__back-btn"),i=document.querySelectorAll(".popup__control-wrap"),u=document.querySelector(".popup__control_brightness"),p=document.querySelector(".popup__control_contrast");n.forEach(e=>{e.addEventListener("click",e=>{n.forEach(e=>{e.pause()});const u=Math.floor(100*e.pageX/s.clientWidth-50),p=Math.floor(100*e.pageY/s.clientHeight-50),d=e.target.getBoundingClientRect().height/s.clientHeight;c=r.querySelector(".card__video"),a=`translate(${u}%, ${p}%) scale(${d})`,c.style.transform=a,r.style.display="block",s.style.overflow="hidden",c.style.transform=a;const _=o(e.target);t(c,`http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2F${_}%2Fmaster.m3u8`),setTimeout(()=>{c.classList.add("popup__video_full"),c.muted=!1,function(e){const t=document.querySelector(".popup__volume"),o=new(window.AudioContext||window.webkitAudioContext);AudioContext||alert("Ваш браузер не поддерживает Web Audio API");const n=o.createMediaElementSource(e),a=o.destination,c=new AnalyserNode(o,{fftSize:64,maxDecibels:-25,minDecibels:-100,smoothingTimeConstant:.8});n.connect(c),c.connect(a),setInterval(()=>{const e=c.frequencyBinCount,o=new Uint8Array(e);c.getByteFrequencyData(o);const n=function(e){return e.reduce((e,t)=>e+t,0)/e.length}(o)/255;t.style.transform=`scaleY(${n})`},200)}(c)},0),setTimeout(()=>{l.classList.add("popup__back-btn_active"),i.forEach(e=>{e.classList.add("popup__control-wrap_active")})},0)})}),l.addEventListener("click",()=>{r.querySelector(".card__video").classList.remove("popup__video_full"),s.style.overflow="auto",l.classList.remove("popup__back-btn_active"),i.forEach(e=>{e.classList.remove("popup__control-wrap_active")}),c.style.transform=a,n.forEach(e=>{e.play()}),setTimeout(function(){r.style.display="none",c.setAttribute("src","")},5e3)}),u.addEventListener("change",e=>{c.style.filter=`brightness(${e.target.value}%)`}),p.addEventListener("change",e=>{c.style.filter=`contrast(${e.target.value}%)`})}();