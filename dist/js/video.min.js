"use strict";!function(){const e=["sosed","cat","dog","hall"];function t(e,t){if(Hls.isSupported()){const o=new Hls;o.loadSource(t),o.attachMedia(e),o.on(Hls.Events.MANIFEST_PARSED,function(){e.play()})}else e.canPlayType("application/vnd.apple.mpegurl")&&(e.src=t,e.addEventListener("loadedmetadata",function(){e.play()}))}function o(t){const o=t.dataset.key;return e[o-1]}const n=Array.from(document.querySelectorAll(".card__video"));let a,c;n.forEach(e=>{t(e,`http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2F${o(e)}%2Fmaster.m3u8`)});const r=document.querySelector(".page__popup"),s=document.querySelector(".page"),l=document.querySelector(".popup__back-btn"),i=document.querySelector(".popup__control-wrap"),u=document.querySelector(".popup__control_brightness"),d=document.querySelector(".popup__control_contrast");n.forEach(e=>{e.addEventListener("click",e=>{n.forEach(e=>{e.pause()}),r.style.display="block",s.style.overflow="hidden";const u=e.target.cloneNode(!0),d=Math.floor(100*e.pageX/s.clientWidth-50),p=Math.floor(100*e.pageY/s.clientHeight-50),_=e.target.getBoundingClientRect().height/s.clientHeight,m=o(e.target);r.insertBefore(u,r.firstChild),t(c=r.querySelector(".card__video"),`http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2F${m}%2Fmaster.m3u8`),a=`translate(${d}%, ${p}%) scale(${_})`,c.style.transform=a,setTimeout(()=>{u.classList.add("popup__video_full"),c.volume=.5,c.muted=!1,function(e){const t=new(window.AudioContext||window.webkitAudioContext);AudioContext||alert("Ваш браузер не поддерживает Web Audio API");const o=t.createMediaElementSource(e),n=t.destination,a=new AnalyserNode(t,{fftSize:256,maxDecibels:-25,minDecibels:-100,smoothingTimeConstant:.8});o.connect(a),a.connect(n),setInterval(()=>{const e=a.frequencyBinCount,t=new Uint8Array(e);a.getByteFrequencyData(t),console.log(t)},1e3)}(c)},0),setTimeout(()=>{l.classList.add("popup__back-btn_active"),i.classList.add("popup__controls_active")},0)})}),l.addEventListener("click",()=>{r.querySelector(".card__video").classList.remove("popup__video_full"),l.classList.remove("popup__back-btn_active"),i.classList.remove("popup__controls_active"),c.style.transform=a,n.forEach(e=>{e.play()}),setTimeout(function(){r.style.display="none",r.querySelector(".card__video").remove()},5e3)}),u.addEventListener("change",e=>{c.style.filter=`brightness(${e.target.value}%)`}),d.addEventListener("change",e=>{c.style.filter=`contrast(${e.target.value}%)`})}();